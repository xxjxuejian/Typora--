## 完全依赖



## 部分依赖

### ✅ 一、部分依赖的定义

> **部分依赖（Partial Dependency）**
>  是指：**一个非主属性只依赖于主键的一部分，而不是整个主键。**

也就是说：

- 当一个关系的主键由**多个属性组成（复合主键）**时，
- 如果有某个非主属性**只依赖主键中的某一个字段**，
- 那就存在**部分依赖**。

------

### ✅ 二、举个直观例子

来看一个学生选课表 👇

| 学号 | 课程号 | 成绩 | 学生姓名 | 课程名称 |
| ---- | ------ | ---- | -------- | -------- |
| 1001 | C01    | 90   | 张三     | 数据库   |
| 1001 | C02    | 85   | 张三     | 操作系统 |
| 1002 | C01    | 88   | 李四     | 数据库   |

------

##### 🔍 分析依赖关系

主键 = （学号, 课程号）
 因为一名学生可以选多门课，单靠“学号”或“课程号”都不能唯一确定一行。

依赖如下：

```
(学号, 课程号) → 成绩      ✅（完整依赖）
学号 → 学生姓名           ❌（部分依赖）
课程号 → 课程名称         ❌（部分依赖）
```

解释：

- “成绩”依赖于整个主键（学号 + 课程号） → 这是**完全依赖**；
- “学生姓名”只依赖“学号”，和“课程号”无关 → 这是**部分依赖**；
- “课程名称”只依赖“课程号”，和“学号”无关 → 也是**部分依赖**。

### ✅ 三、部分依赖造成的问题

1. **数据冗余**
   - “张三”这个名字在每门课程里都重复存储。
2. **更新异常**
   - 改学生姓名，要改多条记录。
3. **插入异常**
   - 想录入一门新课程，还没学生选时，无法确定学号，导致无法插入。
4. **删除异常**
   - 删除最后一个选这门课的学生，会丢失课程信息。

------

### ✅ 四、如何消除部分依赖（达到2NF）

把原表拆分成以下 3 张表：

| 学生表          | 课程表            | 选课表                |
| --------------- | ----------------- | --------------------- |
| 学号 → 学生姓名 | 课程号 → 课程名称 | (学号, 课程号) → 成绩 |

这样：

- 非主属性“成绩”依赖整个主键（学号, 课程号）；
- 不再有非主属性仅依赖主键的一部分；
- ✅ 消除了部分依赖，达到了第二范式（2NF）。



### ✅ 五、补充

#### 1️⃣ 部分依赖的判断标准是：

> 非主属性依赖于主键**的真子集**。

也就是说，要看**左边是否是主键的部分**。



假设一个关系模式：

```mathematica
R(A, B, C, D, E, F)
```

其中：

- **主键是 (A, B)**

- 存在以下函数依赖：

  ```css
  (A, B) → C
  (A, D) → E
  (A) → F
  ```

#### 依赖解释

| 函数依赖   | 含义                            | 是否部分依赖                    |
| ---------- | ------------------------------- | ------------------------------- |
| (A, B) → C | 属性 C 依赖整个主键 (A,B)       | ❌ 完全依赖                      |
| (A, D) → E | E 依赖 A 和 D（与主键部分有关） | ⚠️ 不涉及主键整体，不影响2NF判断 |
| A → F      | F 只依赖主键的一部分 A          | ✅ 这是“部分依赖”                |

> **部分依赖：**
>  当主键由多个属性组成时（例如 (A, B)），
>  若一个非主属性（如 F）只依赖于主键中的**某一个属性（A）或者（B）**，
>  而不是整个主键（A,B），
>  就称为**F 对主键 (A,B) 的部分依赖**。



### 用一个真实场景举例说明

我们构造一个具体的表来体现上面的依赖关系👇

#### 1. 样例数据表

| 学生编号(A) | 课程编号(B) | 成绩(C) | 学期(D) | 辅导员(E) | 学生姓名(F) |
| ----------- | ----------- | ------- | ------- | --------- | ----------- |
| 1001        | C01         | 90      | 2025上  | 王老师    | 张三        |
| 1001        | C02         | 85      | 2025上  | 王老师    | 张三        |
| 1002        | C01         | 88      | 2025下  | 李老师    | 李四        |

***

#### 2. 依赖分析：

- 我们逐一看函数依赖：
  1. **(A, B) → C**
     - “成绩”由“学生编号 + 课程编号”共同决定。
     - ✅ 这是**完全依赖**。
  2. **(A, D) → E**
     - 某个学生在某学期会对应一个辅导员。
     - 例如张三在 2025上 学期由 王老师 辅导。
     - 因此 “辅导员姓名 E” 依赖于“学生编号 + 学期”。
     - 这虽然不是主键 (A, B) 的依赖，但可以视为另一种关系中的依赖。
  3. **A → F**
     - 学生姓名只依赖学生编号。
     - 与课程编号无关。
     - ❌ 这是**部分依赖**（非主属性只依赖主键的一部分）。

***

#### 3. 找出部分依赖

**主键 = (A, B)**

| 属性 | 依赖于 | 类型                     |
| ---- | ------ | ------------------------ |
| C    | (A, B) | ✅ 完全依赖               |
| E    | (A, D) | ⚠️ 其他依赖（非主键依赖） |
| F    | A      | ❌ 部分依赖               |

**→ 非主属性 F（学生姓名）仅依赖于主键的一部分 A。**

 这就是典型的**部分依赖（Partial Dependency）**。



##### 关键点解释：为什么 (A, D) → E 不是部分依赖？

🔹 **理由 1：部分依赖只讨论“主键”内部的依赖。**

- 我们只关心“非主属性是否只依赖了主键的一部分”。
- 而 `(A, D)` 中的 D 根本**不是主键的组成部分**，
   所以它不属于“对主键部分的依赖”，
   它属于“**非主属性对非主属性（或主属性 + 非主属性）**的依赖”。

🔹 **理由 2：它属于另一种问题（可能引向 3NF 的传递依赖）。**

- 因为它说明“E 依赖于 A 之外的别的属性 D”，
   这往往意味着存在 **传递依赖**，是 **第三范式（3NF）** 要解决的范畴。

> ✅ **一句话总结：**
>  部分依赖只讨论“非主属性对主键的依赖是否完整”。
>  如果依赖涉及非主键字段，那就不是部分依赖，而是潜在的**传递依赖**（3NF 关注的内容）。



***

#### 4. 部分依赖带来的问题

| 问题类型 | 示例                                     |
| -------- | ---------------------------------------- |
| 数据冗余 | 张三的名字在每门课程中重复出现           |
| 更新异常 | 改名要改多条记录                         |
| 插入异常 | 想先录入学生，还没选课无法插入           |
| 删除异常 | 删除张三最后一门课记录会导致学生信息丢失 |

***

#### 5. 如何消除部分依赖（转化为 2NF） 

我们拆分成 3 张表👇

##### 1️⃣ 学生表（A → F）

| 学生编号 | 学生姓名 |
| -------- | -------- |
| 1001     | 张三     |
| 1002     | 李四     |

##### 2️⃣ 辅导员表（A, D → E）

| 学生编号 | 学期   | 辅导员 |
| -------- | ------ | ------ |
| 1001     | 2025上 | 王老师 |
| 1002     | 2025下 | 李老师 |

##### 3️⃣ 选课表（A, B → C）

| 学生编号 | 课程编号 | 成绩 |
| -------- | -------- | ---- |
| 1001     | C01      | 90   |
| 1001     | C02      | 85   |
| 1002     | C01      | 88   |

✅ 现在：

- 每个非主属性都完全依赖整个主键；
- 不再存在部分依赖；
- 关系达到了 **第二范式（2NF）**。



## 传递依赖

我们仍然使用这个关系模式：

```mathematica
R(A, B, C, D, E, F)
```

其中：

| 依赖关系   | 说明                     |
| ---------- | ------------------------ |
| (A, B) → C | 学生 A 在课程 B 的成绩   |
| (A, D) → E | 学生 A 在学期 D 的辅导员 |
| A → F      | 学生姓名只依赖学号       |

------

主键是 `(A, B)`
 非主属性：`C, D, E, F`

我们上次已经消除了**部分依赖**（A→F），现在都符合 **第二范式（2NF）**。
 接下来，我们要看**是否符合第三范式（3NF）**。