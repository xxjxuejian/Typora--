### 模块 (Module) 简介

随着我们的应用越来越大，我们想要将其拆分成多个文件，即所谓的“模块（module）”。一个模块可以包含用于特定目的的类或函数库。

很长一段时间，JavaScript 都没有语言级（language-level）的模块语法。这不是一个问题，因为最初的脚本又小又简单，所以没必要将其模块化。

### **一、无模块化时期（ES5 及之前）**

在早期 JavaScript 被设计为网页脚本语言，其用途非常有限，因此并未包含任何模块系统。

### 特点

- 所有脚本通过多个 `<script>` 标签引入，并依赖加载顺序决定依赖关系。
- 所有变量与函数均存放于**全局作用域**，极易产生**命名冲突**。
- 随着业务复杂度上升，代码组织与**维护变得困难**。

这一阶段的 JavaScript 工程缺乏规模化的基础支撑。

------



但是最终脚本变得越来越复杂，因此**社区**发明了许多种方法来将代码组织到模块中，使用特殊的库按需加载模块。

列举一些（出于历史原因）：

### **二、社区主导的模块化探索（2009—2013）**

随着 Web 应用和 Node.js 的兴起，JavaScript 对模块化的需求急剧增加。由于标准迟迟未出台，社区出现多种“民间方案”。

#### 1. **CommonJS（CJS）**

代表环境：**Node.js**
 代表语法：`require()` / `module.exports`

##### 特点

- 采用同步加载，适合本地文件 I/O 的 Node.js 环境。
- 语法简单，使用广泛。
- 由于同步加载，不适合浏览器环境。



#### 2. **AMD（Asynchronous Module Definition）**

代表实现：**RequireJS库**
 代表语法：`define([...], function(...) {})`

##### 特点

- 支持异步加载，专为浏览器环境设计。
- 解决了模块依赖和异步执行的问题。
- 语法相对复杂。

##### 小结

现在，它们都在慢慢成为历史的一部分，但我们仍然可以在旧脚本中找到它们。

在此阶段，模块化主要依靠社区推动，呈现 Node.js（CJS）与浏览器（AMD）两套体系并行的局面。加之后续的 UMD、SeaJS 等方案，整个生态呈现碎片化状态。

------



### **三、构建工具推动的生态融合（2012—2015）**

为了统一开发体验，出现了一批 bundler（打包工具），例如：

- Browserify（将 CommonJS 打包到浏览器中）
- Webpack（支持模块依赖图构建）

这些工具让开发者能够在浏览器项目中使用类似 Node.js 的模块化方式，从而一定程度上缓和了模块体系不统一的问题。

但根本矛盾仍然存在：JavaScript **缺乏原生模块化标准**。

------



语言级的模块系统在 2015 年的时候出现在了标准（ES6）中，此后逐渐发展，现在已经得到了所有主流浏览器和 Node.js 的支持。因此，我们将从现在开始学习现代 JavaScript 模块（module）。

### **四、ES6 正式推出模块化标准：ES Modules（ESM）（2015）**

2015 年 ECMAScript 6（ES2015）正式发布原生模块系统 —— **ES Modules**。

#### ESM 的核心特性

- 使用 **静态导入与导出**（`import` / `export`），便于静态分析与优化。
- 天然支持异步加载，适合浏览器环境。
- 兼容现代打包工具，可实现 tree-shaking（减少包大小）。
- 作为官方标准，具备跨平台统一性。

ESM 的出现标志着 JavaScript 模块化体系第一次由官方正式确立。

------



### **五、现代阶段：统一化进程（2018—至今）**

随着浏览器全面支持 ESM、Node.js（12.x+）逐步原生支持 ESM，JavaScript 模块化进入趋于统一的时代。

#### 当前状况

- 浏览器：默认使用 ESM。
- Node.js：同时支持 CommonJS 与 ES Modules，但逐步鼓励使用 ESM。
- 构建工具（Vite、Rollup、Webpack 等）：以 ESM 为核心基础。

ESM 正在成为前端与 Node.js 共同的主流模块方案。



### 总结：一条清晰的演进路径

| 阶段         | 时间      | 特征                            |
| ------------ | --------- | ------------------------------- |
| 无模块时代   | ES5 之前  | 全局作用域、无组织结构          |
| 社区探索     | 2009–2013 | CJS、AMD、UMD 等多方案并存      |
| 工具融合     | 2012–2015 | Browserify/Webpack 缓解生态割裂 |
| 官方标准化   | 2015      | ES Modules（ESM）推出           |
| 现代统一阶段 | 2018–现在 | 浏览器与 Node 逐步向 ESM 集中   |