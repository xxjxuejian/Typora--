### èƒŒæ™¯çŸ¥è¯†ï¼šè·¨åŸŸ

æµè§ˆå™¨å‡ºäºå®‰å…¨è€ƒè™‘ï¼Œ**ä¸å…è®¸ä¸€ä¸ªç½‘é¡µå»è¯·æ±‚å¦ä¸€ä¸ªä¸åŒæºï¼ˆåè®®+åŸŸå+ç«¯å£ï¼‰çš„èµ„æº**ã€‚è¿™å°±æ˜¯â€œè·¨åŸŸâ€ã€‚

æ¯”å¦‚ï¼š

- ä½ å‰ç«¯é¡µé¢åœ¨ï¼š`http://localhost:3000`
- ä½ è¦è¯·æ±‚çš„APIåœ¨ï¼š`http://localhost:8000`

è¿™å°±æ˜¯ä¸¤ä¸ªä¸åŒçš„æºï¼Œè¯·æ±‚ä¼šè¢«æµè§ˆå™¨æ‹¦æˆªï¼Œæç¤ºè·¨åŸŸï¼ˆCORSï¼‰é”™è¯¯ã€‚



### é…ç½®ä»£ç†çš„ç›®çš„ï¼š

è§£å†³æœ¬åœ°å¼€å‘ä¸­çš„è·¨åŸŸé—®é¢˜ï¼Œå¹¶æ¨¡æ‹Ÿç”Ÿäº§ç¯å¢ƒè¯·æ±‚ API çš„æƒ…å†µã€‚

æœ¬åœ°å¼€å‘æ—¶ï¼Œæ‰§è¡Œ`npm run dev`ä»¥åï¼Œ

- å‰ç«¯è¿è¡Œåœ¨ `http://localhost:3000`
- åç«¯ API æœåŠ¡è¿è¡Œåœ¨ `http://localhost:8000`
- å‰ç«¯ä»£ç ä¸­ä½ å¸Œæœ›è¯·æ±‚ åç«¯æ¥å£`/api/user/list`ï¼Œä½†è¿™ä¼šè·¨åŸŸ



ğŸš« æ²¡æœ‰ä»£ç†æ—¶ï¼š

```js
// axios è¯·æ±‚ä»£ç 
axios.get('/api/user/list')
```

ä½ æœŸæœ›è®¿é—®çš„æ˜¯ `http://localhost:8000/api/user/list`ï¼Œä½†å®é™…ä¸Šæµè§ˆå™¨é»˜è®¤ä¼šè¯·æ±‚å½“å‰ `originï¼š`

```http
GET http://localhost:3000/api/user/list  â† è¿™ä¸ªåœ°å€æ˜¯ä¸å­˜åœ¨çš„
```

å¦‚æœä½ æ”¹æˆï¼š

```js
axios.get('http://localhost:8000/api/user/list')
```

åˆ™ä¼šè·¨åŸŸï¼Œè¢«æµè§ˆå™¨æ‹¦æˆªã€‚



#### ä¸ºä»€ä¹ˆä¼šè¿™æ ·å‘¢ï¼Ÿ

è¿™æ˜¯å› ä¸º **æµè§ˆå™¨åœ¨å¤„ç†ç›¸å¯¹è·¯å¾„æ—¶éµå¾ªé»˜è®¤çš„ URL è§£æè§„åˆ™** â€”â€” ç›¸å¯¹è·¯å¾„æ˜¯åŸºäº**å½“å‰é¡µé¢çš„ originï¼ˆåè®® + åŸŸå + ç«¯å£ï¼‰**è¿›è¡Œè§£æçš„ã€‚

```js
axios.get('/api/user/list')
```

è¿™æ˜¯ä¸€ä¸ª**ç›¸å¯¹è·¯å¾„è¯·æ±‚**ï¼Œå®ƒ**æ²¡æœ‰æŒ‡å®šåè®®ï¼ˆhttp/httpsï¼‰ã€åŸŸåã€ç«¯å£**ã€‚æµè§ˆå™¨å°±ä¼šè‡ªåŠ¨æŠŠå®ƒè¡¥å…¨ä¸ºï¼š

```js
[å½“å‰é¡µé¢çš„ origin] + /api/user/list
// å³
http://localhost:3000/api/user/list
```

å¯¹äºæµè§ˆå™¨æ¥è¯´ï¼Œ`'/api/user/list'`ï¼Œå®ƒ**ä¸æ˜¯ä¸€ä¸ªâ€œå®Œæ•´çš„ URLâ€**ï¼Œå› ä¸ºå®ƒæ²¡æœ‰ï¼š

- åè®®ï¼ˆhttp://ï¼‰
- åŸŸåï¼ˆlocalhostï¼‰
- ç«¯å£ï¼ˆ3000ï¼‰

åªæœ‰è¿™äº›éƒ½æœ‰æ—¶ï¼Œæµè§ˆå™¨æ‰è®¤ä¸ºå®ƒæ˜¯â€œå®Œå…¨çš„ URLâ€ï¼Œæ¯”å¦‚ï¼š

```
axios.get('http://localhost:8000/api/user/list')  // å®Œæ•´ URL
```

`/api/user/list`ï¼Œæ˜¯ç›¸å¯¹äºå½“å‰åŸŸåæ ¹ç›®å½• `/` çš„è·¯å¾„ã€‚

åœ¨æ‰§è¡Œ`npm run dev`ä»¥åï¼Œå‰ç«¯æ˜¯å¼€å¯äº†ä¸€ä¸ªå¼€å‘æœåŠ¡å™¨ï¼Œå¼€å¯ä¸€ä¸ªHTTPæœåŠ¡ï¼š

é»˜è®¤è¿è¡Œåœ¨http://localhost:3000åŸŸåä¸‹ï¼Œå°†é¡¹ç›®æ–‡ä»¶ï¼ˆå¦‚ HTMLã€CSSã€JS ç­‰ï¼‰æ‰˜ç®¡åœ¨è¿™ä¸ªä¸´æ—¶ç¯å¢ƒä¸­ï¼Œé€šè¿‡æµè§ˆå™¨è®¿é—®http://localhost:3000ï¼ŒåŠ è½½çš„å°±æ˜¯å¼€å‘æœåŠ¡å™¨æ‰˜ç®¡çš„å‰ç«¯é¡µé¢ã€‚

`axios.get('/api/user/list')`é’ˆå¯¹è·¯å¾„`/api/user/list`ï¼Œæµè§ˆå™¨ä¼šè®¤ä¸ºè¿™æ˜¯å½“å‰åŸŸåä¸‹çš„ç»å¯¹è·¯å¾„ï¼Œä¼šè‡ªåŠ¨çš„å°†å½“å‰é¡µé¢çš„`origin`ï¼ˆåè®® + åŸŸå + ç«¯å£ï¼‰æ‹¼æ¥åˆ°è·¯å¾„å‰ï¼Œå½¢æˆå®Œæ•´çš„ URL

```js
http://localhost:3000/api/user/list
```

ä¹Ÿå°±æ˜¯è¯´ï¼Œå¯¹äºè¿™ç§è·¯å¾„ï¼Œæµè§ˆå™¨é»˜è®¤æ˜¯å½“å‰åŸŸåä¸‹çš„è·¯å¾„ï¼Œå› ä¸ºè¿™æ ·æ˜¯ä¸ä¼šäº§ç”Ÿè·¨åŸŸçš„ã€‚

ä½†æ˜¯å½“å‰åŸŸåä¸‹å¹¶æ²¡æœ‰åç«¯çš„æ¥å£æœåŠ¡ï¼Œæ‰€ä»¥è®¿é—®ä¸åˆ°ï¼Œè¿˜æ˜¯éœ€è¦è®¿é—®

```js
http://localhost:8000/api/user/list
```

ä½†æ˜¯åŸŸåä¸åŒï¼Œäº§ç”Ÿäº†è·¨åŸŸé—®é¢˜ï¼Œè¿™å°±éœ€è¦é…ç½®ä»£ç†è§£å†³ã€‚



### vite.config.jsé…ç½®

```js
server:{
    proxy: {
      '/b2b': {
        target: 'https://b2b.ebcrack.com',
        changeOrigin: true,
        rewrite: (path) => path.replace(new RegExp('^' + '/b2b'), '')
      }
  	}
}
```

æµè§ˆå™¨ï¼ˆæˆ–ä½ çš„ä»£ç ï¼‰å‘å‡ºçš„è¯·æ±‚æ˜¯ï¼š`/b2b/seller.php?mode=resource_dump&resource_id=30`

#### **ä»£ç†è½¬å‘çš„å·¥ä½œæµç¨‹ ï¼š**

##### 1. æµè§ˆå™¨å‘èµ·è¯·æ±‚ï¼š

â€‹	ä½ çš„å‰ç«¯åº”ç”¨ï¼ˆè¿è¡Œåœ¨ Vite dev server ä¸Šï¼Œä¾‹å¦‚ `http://localhost:xxxx`ï¼‰é€šè¿‡ fetchã€axios æˆ–è€… <img> æ ‡ç­¾çš„ src å‘èµ·äº†ä¸€ä¸ªè¯·æ±‚ã€‚
è¯·æ±‚çš„ URL æ˜¯ï¼š`http://localhost:xxxx/b2b/seller.php?mode=resource_dump&resource_id=30`

##### 2. Vite Dev Server æ‹¦æˆªè¯·æ±‚ï¼š

â€‹	Vite dev server è¿è¡Œåœ¨ `localhost:xxxx`ã€‚å®ƒä¼šæ£€æŸ¥æ‰€æœ‰ä¼ å…¥çš„è¯·æ±‚ã€‚
å®ƒå‘ç°è¯·æ±‚çš„è·¯å¾„ `/b2b/seller.php?mode=resource_dump&resource_id=30` ä»¥ `/b2b` å¼€å¤´ï¼Œè¿™ä¸ä½ ä»£ç†é…ç½®ä¸­çš„ `'/b2b'` é”®åŒ¹é…ã€‚

##### **3. åº”ç”¨ä»£ç†è§„åˆ™*ï¼š**

â€‹	Vite dev server ç¡®å®šè¿™ä¸ªè¯·æ±‚éœ€è¦é€šè¿‡ä»£ç†å¤„ç†ã€‚

â€‹	**ç›®æ ‡ (Target)ï¼š** å®ƒçŸ¥é“ç›®æ ‡æœåŠ¡å™¨æ˜¯ `https://b2b.ebcrack.com`ã€‚

â€‹	**è·¯å¾„é‡å†™ (Rewrite)ï¼š** è¿™æ˜¯å…³é”®çš„ä¸€æ­¥ã€‚

â€‹		**åŸå§‹è¯·æ±‚è·¯å¾„ (path from browser):** `/b2b/seller.php?mode=resource_dump&resource_id=30`

â€‹		**é‡å†™è§„åˆ™:** `path.replace(new RegExp('^' + '/b2b'), '')`

â€‹		**åº”ç”¨é‡å†™ï¼š**
â€‹			åŸå§‹è·¯å¾„ä¸­å¼€å¤´çš„ `/b2b` è¢«æ›¿æ¢ä¸ºç©ºå­—ç¬¦ä¸² ''ã€‚
â€‹			é‡å†™åçš„è·¯å¾„: `/seller.php?mode=resource_dump&resource_id=30`

â€‹	**æ„é€ ç›®æ ‡ URL**

â€‹		Vite dev server ä¼šå°†é‡å†™åçš„è·¯å¾„ä¸ `target` ç»“åˆèµ·æ¥ï¼Œå½¢æˆæœ€ç»ˆè¦è¯·æ±‚çš„ URLã€‚

â€‹		ç›®æ ‡æœåŠ¡å™¨åŸºç¡€ `URL: https://b2b.ebcrack.com`

â€‹		é‡å†™åçš„è·¯å¾„: `/seller.php?mode=resource_dump&resource_id=30`

â€‹		**æœ€ç»ˆè¯·æ±‚çš„ URL (ç”± Vite dev server å‘ç›®æ ‡æœåŠ¡å™¨å‘å‡º):** `https://b2b.ebcrack.com/seller.php?mode=resource_dump&resource_id=30`

##### 4. Vite Dev Server å‘ç›®æ ‡æœåŠ¡å™¨å‘èµ·è¯·æ±‚ï¼š

Vite dev server å‘ `https://b2b.ebcrack.com/seller.php?mode=resource_dump&resource_id=30` å‘èµ·ä¸€ä¸ªæ–°çš„ HTTP GET è¯·æ±‚ã€‚

- `Host` è¯·æ±‚å¤´è®¾ç½®ä¸º `b2b.ebcrack.com` (å› ä¸º `changeOrigin: true`)ã€‚
- å…¶ä»–ç›¸å…³çš„åŸå§‹è¯·æ±‚å¤´éƒ¨ã€æ–¹æ³•ã€æŸ¥è¯¢å‚æ•°å’Œè¯·æ±‚ä½“ï¼ˆå¦‚æœæœ‰ï¼‰éƒ½ä¼šè¢«è½¬å‘ã€‚

##### 5. ç›®æ ‡æœåŠ¡å™¨ (b2b.ebcrack.com) å¤„ç†è¯·æ±‚ï¼š

ç›®æ ‡æœåŠ¡å™¨æ¥æ”¶åˆ°è¯·æ±‚ï¼Œseller.php è„šæœ¬æ‰§è¡Œï¼ŒåŸºäºå‚æ•°å’Œå¯èƒ½çš„ Cookie ç”Ÿæˆå“åº”ã€‚
å‡è®¾å®ƒè¿”å›äº†å›¾ç‰‡æ•°æ®å’Œæ­£ç¡®çš„ `Content-Type: image/...`ã€‚

##### 6. ç›®æ ‡æœåŠ¡å™¨è¿”å›å“åº”ç»™ Vite Dev Serverï¼š

`b2b.ebcrack.com` å°† HTTP å“åº”å‘é€å› Vite dev serverã€‚

##### 7. Vite Dev Server å°†å“åº”è½¬å‘ç»™æµè§ˆå™¨ï¼š

Vite dev server å°†å“åº”è½¬å‘å›æµè§ˆå™¨ã€‚æµè§ˆå™¨è®¤ä¸ºå®ƒæ”¶åˆ°äº†æ¥è‡ª `http://localhost:xxxx/b2b/seller.php?...` çš„å“åº”ã€‚

##### 8. æµè§ˆå™¨å¤„ç†å“åº”ï¼š

æµè§ˆå™¨æ ¹æ® `Content-Type` å’Œå“åº”ä½“æ˜¾ç¤ºå›¾ç‰‡ã€‚