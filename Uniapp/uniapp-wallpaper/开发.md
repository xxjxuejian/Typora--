### 布局

要不要设置全局的内边距，可以看到tabbar页面全部有一个相同的内边距，所有会

不要设置全局的内边距，因为有些页面可能需要铺满全屏的，除非可以确定每一个页面的布局，否则还是建议单个页面单独设置。



各种内置组件view，swiper，swiper-item设置为border-box，重置样式。



### image组件的mode模式



![image-20250828174838276](./../../typora-pic/image-20250828174838276.png)







在项目根目录的 `App.vue` 中，引入上述的 `iconfont.css`，注意自己存放的路径，且通过 `@import` 引入的外部样式，需要写在 `style` 标签有效内容中的最前面

```html
<!-- App.vue -->
<style>
@import "@/static/iconfont.css";
</style>
```

用 `custom-prefix` 和 `type` 属性自定义图标

```html
<uni-icons custom-prefix="iconfont" type="icon-shuaxin" size="30"></uni-icons>
```









文本溢出显示省略号，只有给文字的最近容器设置对应的样式才生效



`scroll-view`横向滚动，比如设置

```css
scroll-view {
    white-space: nowrap;
}
```

而且内部的子元素是行内块元素：`display: inline-block;`



scroll-view不支持flex,默认block;



页面跳转

`<navigator>`组件导航到`tabBar`页面与其它页面有什么区别吗

跳转tabBar	

```vue
<navigator url="/pages/classify/classify" open-type="reLaunch"></navigator>
```

js导航呢





### linear-gradient

怎么理解这个

```css
  // 渐变:写在最上面的,层级最高
  background: linear-gradient(to bottom, transparent, #fff 400rpx),
    linear-gradient(to right, #beecd8 20%, #f4e2d8);
```



### 小程序中的联系客服

https://mp.weixin.qq.com/ 中获取AppID

进入`基础功能`->`客服`：

首先添加客服，输入对应的微信号

![image-20250901143537004](./../../typora-pic/image-20250901143537004.png)

使用客服账号，扫描对应的码

![image-20250901143914683](./../../typora-pic/image-20250901143914683.png)



联系客服只能通过`button`实现，无法通过`js`实现跳转

```vue
<button open-type="contact">联系客服</button>
```





### CSS选择器：

```sql
view.section
  ├─ navigator
  │    └─ view.row  
  ├─ navigator
  │    └─ view.row   ← 需要控制

```

想选中 **`.section` 下最后一个 `.row`**，但是 `.row` 外层还有 `navigator`。

不能直接用 `.section .row:last-child`，那会选到每个 `navigator` 内部的最后一个 `.row`（而不是整个 section 内最后一个）。

✅ 正确写法：利用 `navigator:last-child .row`

```css
.section navigator:last-child .row {
  border: none; /* 或者 border-bottom: none; */
}
```



### 自定义顶部导航

#### navigationStyle:

`pages.json`  ->  `pages`  -> `style`  -> `navigationStyle`

导航栏样式，仅支持 `default/custom`。`custom`即取消默认的原生导航栏

`default`的效果如下，分别为H5和微信小程序中的显示效果

![image-20250901180244351](./../../typora-pic/image-20250901180244351.png)

```json
{
    "path": "pages/user/index",
    "style": {
        "navigationBarTitleText": "我的",
        "navigationStyle": "custom"
    }
},
```

`custom`的效果如下，分别为H5和微信小程序中的显示效果

![image-20250901180457583](./../../typora-pic/image-20250901180457583.png)



区别就时顶部的标题导航没有了，我们可以自定义一个标题栏。

但是需要注意一点的是，现在内容区已经是从屏幕顶部开始了，但是手机的顶部还有一个状态栏会显示信息

![image-20250901181725008](./../../typora-pic/image-20250901181725008.png)

![image-20250901181916977](./../../typora-pic/image-20250901181916977.png)

像现在这样就是内容已经把状态栏遮住了，所以我们需要在顶部把状态栏高度留出来。



#### 状态栏与menuButton

在小程序中设置了自定义的顶部导航栏时，由于设置了`"navigationStyle": "custom"`，顶部导航栏就会把占据手机状态栏的位置

![image-20250902171050006](./../../typora-pic/image-20250902171050006.png)



**微信小程序：**

状态栏高度44px，但是`title`还是没有和**menuButton**对齐

这是因为**menuButton**的`top:48px`，这说明**menuButton**的**顶部**`statusBar`的**底部**有4px的距离，而且**menuButton**的底部距离下面也有4px，所以我们需要按照**menuButton**的整体高度来设置

![image-20250902180936637](./../../typora-pic/image-20250902180936637.png)

**示意图：**

![image-20250902194005872](./../../typora-pic/image-20250902194005872.png)

可以认为整个胶囊按钮的高度是 4 + 4 + 32 = 40px。如果有盒子需要与胶囊按钮并排，就可以设置高度40px，然后内容垂直居中即可。



获取状态栏高度与胶囊按钮高度：

```js
export function useSystemInfo() {
  // 系统信息
  const systemInfo = uni.getSystemInfoSync();
  // 状态栏高度（所有端都有），但是h5的值是0
  const statusBarHeight = ref(systemInfo.statusBarHeight || 15);
  // 标题栏高度（不同端不同逻辑）
  const titleBarHeight = ref(40); // 默认一个常见值
  let menuButtonInfo = null;

  // 根据文档，在App与H5，没有该API getMenuButtonBoundingClientRect
  // #ifdef MP
  try {
    menuButtonInfo = uni.getMenuButtonBoundingClientRect();
    titleBarHeight.value =
      menuButtonInfo.height + (menuButtonInfo.top - statusBarHeight.value) * 2;
  } catch (e) {
    console.warn("获取胶囊信息失败：", e);
  }
  // #endif

  // #ifndef MP
  // H5/App 没有胶囊按钮，通常导航栏高度固定，可以按 UI 设计稿调整
  titleBarHeight.value = 40;
  // #endif

  // const topPlaceHolderHeight = statusBarHeight.value + titleBarHeight.value;

  return {
    systemInfo,
    menuButtonInfo,
    statusBarHeight,
    titleBarHeight,
  };
}
```



### 底部安全区域

手机底部会有一个手势指示条或者是虚拟按键

![image-20250903170000459](./../../typora-pic/image-20250903170000459.png)

或者

![image-20250903170411770](./../../typora-pic/image-20250903170411770.png)

所以页面底部需要预留出，直接设置一个类就行，`env(safe-area-inset-bottom)`可以直接使用的

```scss
.safe-area-inset-bottom {
    height: env(safe-area-inset-bottom);
}
```



所有的网络请求如果出错时的处理，`.vue`文件中的调用出错的处理





### 下拉刷新，触底加载

直接使用z-paging插件

![image-20250903162859958](./../../typora-pic/image-20250903162859958.png)

```vue
<template>
  <z-paging
    ref="paging"
    v-model="categoryList"
    @query="queryList"
    :default-page-size="15">
    <!-- 下拉刷新的加载动画与文本 -->
    <template #refresher="{ refresherStatus }">
      <custom-refresher :status="refresherStatus" />
    </template>

    <custom-nav-bar title="分类"></custom-nav-bar>
    <view class="category pageBg">
      <view class="category-list">
        <category-item
          v-for="item in categoryList"
          :key="item._id"
          :item="item"
          class="item"></category-item>
      </view>
    </view>

    <template #loadingMoreNoMore>
      <!-- 此处的custom-nomore为demo中自定义的组件，非z-paging的内置组件，请在实际项目中自行创建。
			这里插入什么view，没有更多数据就显示什么view -->
      <custom-nomore />
    </template>
  </z-paging>
</template>
```



图片列表已经返回了每一张图的详情，点击预览，以及预览页需要展示的数据，都在列表页已经获取了。

所以进入到预览页时，不要再次获取数据了

把之前的列表页面数据保存，在预览页中获取，即可显示





### 保存图片到手机相册

对于网络图片地址，需要先配置小程序的开发设置：

![image-20250904161605218](./../../typora-pic/image-20250904161605218.png)



服务内容声明

使用权限之前需要到， 微信小程序后台，添加对应的权限

![image-20250904171938537](./../../typora-pic/image-20250904171938537.png)



![image-20250904172036709](./../../typora-pic/image-20250904172036709.png)



![image-20250904172051658](./../../typora-pic/image-20250904172051658.png)



```js
// 初次调用会触发用户授权
uni.saveImageToPhotosAlbum({
    filePath:path,
    success: (res) => {
        console.log('下载结果',res);
    },
    fail: (err) => {
        console.log('错误',err)
    }
})
```

![image-20250904173144726](./../../typora-pic/image-20250904173144726.png)

点击拒绝会触发`fail`回调，

再次点击下载，会一直进入`fail`回调，



拒绝以后，弹出提示框：

![image-20250904180637531](./../../typora-pic/image-20250904180637531.png)

如果点击取消，

如果点击确定，导航到用户开启权限

![image-20250904181057999](./../../typora-pic/image-20250904181057999.png)

这里可能是开启了，然后返回；也可能是没有开启，然后返回；所以还要判断

开启或者不开启，都是进入`success`回调，只是内部参数值不同







```
	// #ifdef H5
		uni.showModal({
			title:'下载提示'
			content:"无法下载",
		})
	// #endif

	// #ifndef H5
	const path = await getImageInfo()
		uni.saveImageToPhotosAlbum({
			filePath:path,
			success: (res) => {
						uni.showToast({
							title: "保存成功，请到相册查看",
							icon: "none",
						});
			},
			fail: (err) => {
				console.log('错误',err)
			}
		})
	// #endif
```



### 进入方式

用户直接进入小程序，正常使用

用户通过其他用户分享进入小程序，

有些样式与互动的逻辑不太一样



清缓存

信息弹出的底部安全区域
